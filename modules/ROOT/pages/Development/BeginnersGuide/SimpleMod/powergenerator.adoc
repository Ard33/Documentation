= Custom Power Generator

In this chapter, we will create a Solar Panel - a custom power generator that produces energy during the daytime only.

== Create the buildable

As in previous examples, we need to create another xref:Development/BeginnersGuide/SimpleMod/buildable.adoc[buildable] (let's name it `Build_DocSolarPanel`) with a descriptor and recipe for it and add it to our schematic.
But this time we will use `FGBuildableGenerator` as a base class for our buildable as it's the base class for buildings that generate power.

TODO: add static mesh for solar panel

[TIP]
=====
There are also subclasses of `FGBuildableGenerator` like `FGBuildableGeneratorFuel`, `FGBuildableGeneratorGeoThermal`, and `FGBuildableGeneratorNuclear` which, as you can judge from their names, contain some specific logic for different types of power generators but, as our Solar Panel does not require any of these, we will not use them.
=====

So go ahead and create all this stuff, the bare minimums should be the same as in the previous chapters with the only exception that we want a different `M Hologram Class` of our buildable. Instead of `FGBuildableHologram` we will set it to `FGFactoryHologram` as `FGBuildableGenerator` that we are deriving from is a child of `FGBuildableFactory`.

As of now, we should have the basic building that is available ingame and can be built but does nothing.. just yet!

== Adding power generation logic

The first thing we want to add to our `Build_DocSolarPanel` is `FGPowerConnection` component as we would need to connect our Solar Panel to other buildings that we want to transfer its generated power to. You've done it before in the xref:Development/BeginnersGuide/SimpleMod/machines/SimpleMachine.adoc[Simple Machine] chapter so just do the same.
Another component we need is `FGPowerInfo` (same as with Simple Machine) but this time we don't need to add it ourselves as `FGBuildableGenerator` class already contains one.

We need to run our logic only once so the best place to put it is `Build_DocSolarPanel`'s `BeginPlay` event. First, we set the `PowerInfo` of `FGPowerConnection` using `Set Power Info` node. Remember how I said that there `FGPowerInfo` already exists for us? You can get it by `Get Power Info` node. Then, we need to set the amount of power our Solar Panel would produce and we can do that with `PowerInfo`'s `Set Base Production` node, specifying the amount of, for example, 20.0.
For now, the code should look like this:

image:BeginnersGuide/simpleMod/SolarPanel_1.png[image]

With this code, we now have a generator that always produces power but we want it to work during the daytime only. To do that, we would first need to figure out whether it's day or night and set the base production amount accordingly. For that we can use `Is Day` method of `FGTimeOfDaySubsystem` that we can get with `GetTimeSubsystem` node. Combining it with `Select Float` node we get the base production set depending on the time of day:

image:BeginnersGuide/simpleMod/SolarPanel_2.png[image]

The only thing left to do is to switch the Solar Panel's power when the day/night cycle proceeds. For that, we can subscribe to `OnDayStateChanged` delegate of the time subsystem to know when this happens and switch our generator accordingly. We will bind a custom event to the delegate using `Bind Event to OnDayStateChanged` node, providing it with the time subsystem object. We can create the event (let's name it `mOnDayStateChanged`) by using `Add Custom Event...` action or by dragging from `Event` pin of `Bind Event to OnDayStateChanged` node. And the event would set the base production amount in the same way as we did before:

image:BeginnersGuide/simpleMod/SolarPanel_3.png[image]

So the whole code for our Sonar Panel would look like this:

image:BeginnersGuide/simpleMod/SolarPanel_4.png[image]

That should be it, try out your newly created power generator!

[TIP]
=====
Instead of waiting for the day/night cycle to proceed, you can use `SetTimeOfDay` console command. More info xref:SMLChatCommands.adoc[here].
=====
